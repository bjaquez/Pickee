"use strict";$(document).ready(function(){var t=localStorage.getItem("date"),o=localStorage.getItem("budget"),e=localStorage.getItem("city");$(".show-budget").text(o),$.ajax({url:"https://app.ticketmaster.com/discovery/v2/events.json?apikey=6mHrAZ3CTRq1nKViJch0zM8cMGHPzav6&classificationName=music&size=50&city="+e+"&startDate="+t,method:"GET"}).then(function(t){var i=t._embedded.events.filter(function(t){return t.priceRanges}).filter(function(t){return t.priceRanges[0].max<=o});i=i.slice(0,12),$(".carouselConcerts .carousel-item .concert").each(function(t){var e=i[t].images.findIndex(function(t){return 205===t.width}),a=i[t].images[e].url,n=i[t].url,r=i[t].priceRanges[0].min,c=i[t].name,s=i[t].dates.start.localDate;$(this).find("img").attr("src",a),$(this).append('\n            <p><a href= "'.concat(n,'" class="data-url-link" target = \'_blank\'>').concat(c,"</a></p>\n            <h5>").concat(s,"</h5> \n            <h5>$").concat(r,'<button style=\'margin-left: 70px;\' class = "btn btn-sm btn-outline-danger favorite" event-image ="').concat(a,'" event-name = "').concat(c,'" event-price = "').concat(r,'" event-url = "').concat(n,"\"><i class='far fa-heart'></i></button></h5>\n        "))})});var l=[],u=0,p={},d=!1,m=localStorage.getItem("favs"),v=m?JSON.parse(m):[];function f(t,e){return t+e}$(".total").text(u),0<v.length&&$(v).each(function(t){var e=$("<div class='chosen-div'>"),a=$('<span data-id="'.concat(v[t].count,'">')),n=$("<img class='img-picked' />").attr("src",v[t].image),r=$('\n                <h6 class="favorite-title">\n                    <p>\n                        <a href="'.concat(v[t].url,'" target="_blank">').concat(v[t].name,"</a>\n                    </p>\n                </h6>\n            ")),c=$('<h6 class="favorite-title">$'.concat(v[t].price," x ").concat(v[t].count,"</h6>"));if(c.append(a),e.attr("chosen-price",v[t].price),e.append(n,r,c),l.push(parseFloat(v[t].price*v[t].count)),u=l.reduce(f,0),$(".total").text(u),$(".picked-events").append(e),$(".picked-events").show(),u>parseFloat(o)&&!d){var s=$("<p class='budget over'>").text("Over Budget!");d=!0,$(".budget").append(s),$(".picked-events").addClass("over-budget")}}),$(document).on("click",".favorite",function(){$(".picked-events").show();var t=$("<div class = chosen-div>"),e=$("<span data-id = '"+$(this).attr("event-name").replace("'","")+"'>"),a=$("<img class = 'img-picked'>").attr("src",$(this).attr("event-image")),n=$("<h6 class = 'favorite-title'>").append('\n        <p><a class = "data-url-link-2" href= "'.concat($(this).attr("event-url"),"\" target = '_blank'>").concat($(this).attr("event-name"),"</a></p> \n        ")),r=$("<h6 class = 'favorite-title'>").text("$"+$(this).attr("event-price")+" x ");r.append(e),t.attr("chosen-price",$(this).attr("event-price")),t.append(a,n,r),m=localStorage.getItem("favs"),v=m?JSON.parse(m):v;var c=$(this).attr("event-name");if(c in p&&p.hasOwnProperty(c)){p[c]++,$("span[data-id = '"+c.replace("'","")+"']").text(p[c]);var s=v.findIndex(function(t){return t.name===c});v[s].count+=1}else p[c]=1,$(".picked-events").append(t),e.text(p[c]),v.push({image:$(this).attr("event-image"),name:c,price:$(this).attr("event-price"),url:$(this).attr("event-url"),count:p[c]});if(localStorage.setItem("favs",JSON.stringify(v)),e.text(p[$(this).attr("event-name")]),l.push(parseFloat(t.attr("chosen-price"))),u=l.reduce(f,0),$(".total").text(u),u>parseFloat(o)&&!1===d){d=!0;var i=$("<p class = 'budget over'>").text("Over Budget!");$(".over").append(i),$(".picked-events").addClass("over-budget")}}),$(document).on("click",".clear",function(){$(".picked-events").empty(),$(".picked-events").hide(),$(".over").empty(),$(".picked-events").removeClass("over-budget"),d=!1,l=[],u=0,p={},$(".total").text(u),localStorage.removeItem("favs"),v=[]}),$.ajax({url:"https://app.ticketmaster.com/discovery/v2/events.json?apikey=ugXRSfv8iRIcixf8XbiSrD0iIgYgOHFq&classificationName=sports&size=50&city="+e+"&startDate="+t,method:"GET"}).then(function(t){var i=t._embedded.events.filter(function(t){return t.priceRanges}).filter(function(t){return t.priceRanges[0].min<=o});i=i.slice(0,12),$(".carouselSports .carousel-item .sports").each(function(t){var e=i[t].images.findIndex(function(t){return 205===t.width}),a=i[t].images[e].url,n=i[t].url,r=i[t].priceRanges[0].min,c=i[t].name,s=i[t].dates.start.localDate;$(this).find("img").attr("src",a),$(this).append('\n            <p><a href= "'.concat(n,'" class ="data-url-link" target = \'_blank\'>').concat(c,"</a></p>\n            <h5>").concat(s,"</h5> \n            <h5>$").concat(r,"<button style='margin-left: 70px;' class = 'btn btn-sm btn-outline-danger favorite' event-image =\"").concat(a,'" event-name = "').concat(c,'" event-price = "').concat(r,'" event-url = "').concat(n,"\"><i class='far fa-heart'></i></button> </h5>\n        "))})})}),$(document).ready(function(){$("#submit_button").click(function(){localStorage.removeItem("favs");var t=$("#dateInput").val(),e=$("#budgetInput option:selected").val(),a=$("#cityInput").val();/^\d{4}\-(0[1-9]|1[0-2])\-(0[1-9]|1[0-9]|2[0-9]|3[0-1])$/i.test(t)?($("#dateInput").removeClass("wrong-input"),$(".c-date").empty(),$(".submit").attr("href","homepage.html"),localStorage.setItem("date",t)):($("#dateInput").addClass("wrong-input"),$("#dateInput").attr("placeholder","YYYY-MM-DD"),$(".c-date").text("Incorrect date format"),$(".submit").attr("href","#"),event.preventDefault()),/^\w{2,}(\s\w{2,}){0,2}$/i.test(a)?($("#cityInput").removeClass("wrong-input"),$(".c-city").empty(),$(".submit").attr("href","homepage.html"),localStorage.setItem("city",a)):($("#cityInput").addClass("wrong-input"),$(".c-city").text("Invalid city"),$(".submit").attr("href","#"),event.preventDefault()),"Select budget"===e?($("#budgetInput").addClass("wrong-input"),$(".c-budget").text("Choose Budget"),$(".submit").attr("href","#"),event.preventDefault()):($("#budgetInput").removeClass("wrong-input"),$(".c-budget").empty(),$(".submit").attr("href","homepage.html"),localStorage.setItem("budget",e))})}),$(document).ready(function(){$(".nav-restaurants").click(function(){$("html,body").animate({scrollTop:$(".nav2-restaurants").offset().top},"slow")}),$(".nav-concerts").click(function(){$("html,body").animate({scrollTop:$(".nav2-concerts").offset().top},"slow")}),$(".nav-sporting-events").click(function(){$("html,body").animate({scrollTop:$(".nav2-sporting-events").offset().top},"slow")}),$(".data-home-footer").click(function(){$("html,body").animate({scrollTop:$(".data-home").offset().top},"slow")}),$(".nav-cart").click(function(){$("html,body").animate({scrollTop:$(".shopping-cart").offset().top},"slow")}),$(".disclaimer").click(function(){$("#myInput").trigger("focus")})});var userParams={location:localStorage.getItem("city"),maxBudget:localStorage.getItem("budget")},dollars={$:8,$$:15,$$$:40,$$$$:61},restaurantColumns=$(".carouselRestaurants .business"),getBusinessesWithPrices=function(t){return t.filter(function(t){return t.price})},sortYelpBusinesses=function(t){var e=t.slice();return e.sort(function(t,e){if(e.rating<t.rating)return-1;if(t.rating<e.rating)return 1;if(t.price&&e.price){if(e.price>t.price)return-1;if(t.price>e.price)return 1}return 0}),e.splice(0,12)},appendYelpBusinessElements=function(i){restaurantColumns.each(function(t){var e=i[t],a=e.rating,n=e.url,r=e.image_url,c=e.price,s=e.name;c=c?dollars[c]:"No Price",$(this).find("img").attr("src",r),$(this).append('\n            <p class="my-0">\n                <a href="'.concat(n,'" class="data-url-link" target="_blank">').concat(s,'</a>\n            </p>\n            <p class="my-0">Rating: ').concat(a,'</p>\n            <p class="my-0">Price: $').concat(c.toFixed(2),'\n                <button style="margin-left: 70px;" class="btn btn-sm btn-outline-danger favorite" event-image="').concat(r,'" event-name="').concat(s,'" event-price="').concat(c,'" event-url = "').concat(n,'"><i class="far fa-heart"></i></button>\n            </p>\n        '))})},getSortCreateYelpBusinessElements=function(t){var e=encodeURI(t.location),a="https://cors-anywhere.herokuapp.com/https://api.yelp.com/v3/businesses/search?term=food&location=".concat(e);$.ajax({url:a,method:"GET",headers:{Authorization:"Bearer EJvbHZiIs5OmP2i5jEPAjK0KB_29Wfx32FSli4YZvCVm4Gk6No0ahTnITakE3XdySd5oVBrVAAMnOIekQUe4dTRbRLsRFp--ND9BPuY7WbBqiGcsulqlu6XI3oWRW3Yx"}}).then(function(t){var e=t.businesses,a=getBusinessesWithPrices(e),n=sortYelpBusinesses(a);appendYelpBusinessElements(n)})};getSortCreateYelpBusinessElements(userParams);
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFwcC5qcyIsImxvZ2ljX2Zyb250cGFnZS5qcyIsImxvZ2ljX2hvbWVwYWdlLmpzIiwieWVscC5qcyJdLCJuYW1lcyI6WyIkIiwiZG9jdW1lbnQiLCJyZWFkeSIsImRhdGUiLCJsb2NhbFN0b3JhZ2UiLCJnZXRJdGVtIiwiYnVkZ2V0IiwiY2l0eSIsInRleHQiLCJhamF4IiwidXJsIiwibWV0aG9kIiwidGhlbiIsInJlc3BvbnNlIiwiZXZlbnRzSW5CdWRnZXQiLCJfZW1iZWRkZWQiLCJldmVudHMiLCJmaWx0ZXIiLCJldmVudCIsInByaWNlUmFuZ2VzIiwibWF4Iiwic2xpY2UiLCJlYWNoIiwiaSIsImltYWdlSW5kZXgiLCJpbWFnZXMiLCJmaW5kSW5kZXgiLCJpbWFnZSIsIndpZHRoIiwiZXZlbnRJbWFnZSIsImV2ZW50VXJsIiwiZXZlbnRQcmljZSIsIm1pbiIsImV2ZW50TmFtZSIsIm5hbWUiLCJldmVudERhdGUiLCJkYXRlcyIsInN0YXJ0IiwibG9jYWxEYXRlIiwidGhpcyIsImZpbmQiLCJhdHRyIiwiYXBwZW5kIiwiY29uY2F0IiwiY2hvc2VuUHJpY2VzIiwidG90YWwiLCJmYXZvcml0ZXMiLCJvdmVyIiwiZmF2U3RyaW5nIiwiZmF2cyIsIkpTT04iLCJwYXJzZSIsImFkZCIsImEiLCJiIiwibGVuZ3RoIiwiaW5kZXgiLCIkZGl2IiwiJGNvdW50ZXIiLCJjb3VudCIsIiRmYXZJbWFnZSIsIiRmYXZUaXRsZSIsIiRmYXZQcmljZSIsInByaWNlIiwicHVzaCIsInBhcnNlRmxvYXQiLCJyZWR1Y2UiLCJzaG93Iiwib3ZlckJ1ZGdldCIsImFkZENsYXNzIiwib24iLCJldmVudERpdiIsImNvdW50ZXIiLCJyZXBsYWNlIiwiZXZlbnRDaG9zZW4iLCJldmVudFRpdGxlIiwiZXZlbnROYW1lU3RyaW5nIiwiaGFzT3duUHJvcGVydHkiLCJmYXYiLCJzZXRJdGVtIiwic3RyaW5naWZ5IiwiZW1wdHkiLCJoaWRlIiwicmVtb3ZlQ2xhc3MiLCJyZW1vdmVJdGVtIiwiY2xpY2siLCJkYXRlX2lucHV0IiwidmFsIiwiYnVkZ2V0X2lucHV0IiwiY2l0eV9pbnB1dCIsInRlc3QiLCJwcmV2ZW50RGVmYXVsdCIsImFuaW1hdGUiLCJzY3JvbGxUb3AiLCJvZmZzZXQiLCJ0b3AiLCJ0cmlnZ2VyIiwidXNlclBhcmFtcyIsImxvY2F0aW9uIiwibWF4QnVkZ2V0IiwiZG9sbGFycyIsIiQkIiwiJCQkIiwiJCQkJCIsInJlc3RhdXJhbnRDb2x1bW5zIiwiZ2V0QnVzaW5lc3Nlc1dpdGhQcmljZXMiLCJidXNpbmVzc2VzIiwiYnVzaW5lc3MiLCJzb3J0WWVscEJ1c2luZXNzZXMiLCJieUJlc3RSYXRpbmciLCJzb3J0IiwicmF0aW5nIiwic3BsaWNlIiwiYXBwZW5kWWVscEJ1c2luZXNzRWxlbWVudHMiLCJfYnVzaW5lc3NlcyRpbmRleCIsImltYWdlX3VybCIsInRvRml4ZWQiLCJnZXRTb3J0Q3JlYXRlWWVscEJ1c2luZXNzRWxlbWVudHMiLCJlbmNvZGVkTG9jYXRpb24iLCJlbmNvZGVVUkkiLCJoZWFkZXJzIiwiQXV0aG9yaXphdGlvbiIsInJlcyIsImJ1c2luZXNzZXNXaXRoUHJpY2VzIiwic29ydGVkQnVzaW5lc3NlcyJdLCJtYXBwaW5ncyI6ImFBQUFBLEVBQUVDLFVBQVVDLE1BQU0sV0FHZCxJQUFJQyxFQUFPQyxhQUFhQyxRQUFRLFFBQzVCQyxFQUFTRixhQUFhQyxRQUFRLFVBQzlCRSxFQUFPSCxhQUFhQyxRQUFRLFFBRWhDTCxFQUFFLGdCQUFnQlEsS0FBS0YsR0FFdkJOLEVBQUVTLEtBQUssQ0FDSEMsSUFBSyx1SUFBeUlILEVBQU8sY0FBZ0JKLEVBQ3JLUSxPQUFRLFFBQ1RDLEtBQUssU0FBVUMsR0FFZCxJQU1JQyxFQU5jRCxFQUFTRSxVQUFVQyxPQUVHQyxPQUFPLFNBQVVDLEdBQ3JELE9BQU9BLEVBQU1DLGNBRzBCRixPQUFPLFNBQVVDLEdBQ3hELE9BQU9BLEVBQU1DLFlBQVksR0FBR0MsS0FBT2QsSUFHdkNRLEVBQWlCQSxFQUFlTyxNQUFNLEVBQUcsSUFF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R0FDL0NrQixFQUFtQmhCLG1CQUFtQmUsR0FDdENWLDJCQUEyQlcsTUFNbkNQLGtDQUFrQ3BCIiwiZmlsZSI6InNjcmlwdHMuanMiLCJzb3VyY2VzQ29udGVudCI6WyIkKGRvY3VtZW50KS5yZWFkeShmdW5jdGlvbiAoKSB7XG4gICAgLy8gdmFyaWFibGVzIGZvciBhamF4IGNhbGwgXG4gICAgLy8gd2lsbCByZXBsYWNlIHdpdGgganF1ZXJ5IGxvY2F0b3IsIHVzaW5nIHBsYWNlaG9sZGVyIGZvciBub3cgXG4gICAgdmFyIGRhdGUgPSBsb2NhbFN0b3JhZ2UuZ2V0SXRlbShcImRhdGVcIik7XG4gICAgdmFyIGJ1ZGdldCA9IGxvY2FsU3RvcmFnZS5nZXRJdGVtKFwiYnVkZ2V0XCIpO1xuICAgIHZhciBjaXR5ID0gbG9jYWxTdG9yYWdlLmdldEl0ZW0oXCJjaXR5XCIpO1xuXG4gICAgJChcIi5zaG93LWJ1ZGdldFwiKS50ZXh0KGJ1ZGdldCk7XG4gICAgLy90aWNrZXRtYXN0ZXIgbXVzaWMgZXZlbnRzIFxuICAgICQuYWpheCh7XG4gICAgICAgIHVybDogXCJodHRwczovL2FwcC50aWNrZXRtYXN0ZXIuY29tL2Rpc2NvdmVyeS92Mi9ldmVudHMuanNvbj9hcGlrZXk9Nm1IckFaM0NUUnExbktWaUpjaDB6TThjTUdIUHphdjYmY2xhc3NpZmljYXRpb25OYW1lPW11c2ljJnNpemU9NTAmY2l0eT1cIiArIGNpdHkgKyBcIiZzdGFydERhdGU9XCIgKyBkYXRlLFxuICAgICAgICBtZXRob2Q6IFwiR0VUXCJcbiAgICB9KS50aGVuKGZ1bmN0aW9uIChyZXNwb25zZSkge1xuXG4gICAgICAgIHZhciBtdXNpY0V2ZW50cyA9IHJlc3BvbnNlLl9lbWJlZGRlZC5ldmVudHM7XG4gICAgICAgIC8vY3JlYXRlcyBhcnJheSB3aXRoIG9ubHkgZXZlbnRzIHRoYXQgaGF2ZSBwcmljZSByYW5nZXMgXG4gICAgICAgIHZhciBldmVudHNXaXRoUHJpY2VSYW5nZXMgPSBtdXNpY0V2ZW50cy5maWx0ZXIoZnVuY3Rpb24gKGV2ZW50KSB7XG4gICAgICAgICAgICByZXR1cm4gZXZlbnQucHJpY2VSYW5nZXM7XG4gICAgICAgIH0pO1xuICAgICAgICAvLyBjcmVhdGVzIGFycmF5IHdpdGggb25seSBldmVudHMgdGhhdCBoYXZlIGEgbWF4IHByaWNlIHdpdGhpbiB1c2VyIGJ1ZGdldCBcbiAgICAgICAgdmFyIGV2ZW50c0luQnVkZ2V0ID0gZXZlbnRzV2l0aFByaWNlUmFuZ2VzLmZpbHRlcihmdW5jdGlvbiAoZXZlbnQpIHtcbiAgICAgICAgICAgIHJldHVybiBldmVudC5wcmljZVJhbmdlc1swXS5tYXggPD0gYnVkZ2V0O1xuICAgICAgICB9KTtcbiAgICAgICAgLy8gY3JlYXRlcyBhcnJheSB3aXRoIG9ubHkgMTIgZXZlbnRzIFxuICAgICAgICBldmVudHNJbkJ1ZGdldCA9IGV2ZW50c0luQnVkZ2V0LnNsaWNlKDAsIDEyKTtcblxuICAgICAgICB2YXIgY29uY2VydENhcm91c2VsSXRlbXMgPSAkKFwiLmNhcm91c2VsQ29uY2VydHMgLmNhcm91c2VsLWl0ZW0gLmNvbmNlcnRcIik7XG5cbiAgICAgICAgY29uY2VydENhcm91c2VsSXRlbXMuZWFjaChmdW5jdGlvbiAoaSkge1xuICAgICAgICAgICAgdmFyIGltYWdlSW5kZXggPSBldmVudHNJbkJ1ZGdldFtpXS5pbWFnZXMuZmluZEluZGV4KGZ1bmN0aW9uIChpbWFnZSkge1xuICAgICAgICAgICAgICAgIHJldHVybiBpbWFnZS53aWR0aCA9PT0gMjA1O1xuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB2YXIgZXZlbnRJbWFnZSA9IGV2ZW50c0luQnVkZ2V0W2ldLmltYWdlc1tpbWFnZUluZGV4XS51cmw7XG4gICAgICAgICAgICB2YXIgZXZlbnRVcmwgPSBldmVudHNJbkJ1ZGdldFtpXS51cmw7XG4gICAgICAgICAgICB2YXIgZXZlbnRQcmljZSA9IGV2ZW50c0luQnVkZ2V0W2ldLnByaWNlUmFuZ2VzWzBdLm1pbjtcbiAgICAgICAgICAgIHZhciBldmVudE5hbWUgPSBldmVudHNJbkJ1ZGdldFtpXS5uYW1lO1xuICAgICAgICAgICAgdmFyIGV2ZW50RGF0ZSA9IGV2ZW50c0luQnVkZ2V0W2ldLmRhdGVzLnN0YXJ0LmxvY2FsRGF0ZTtcbiAgICAgICAgICAgICQodGhpcykuZmluZChcImltZ1wiKS5hdHRyKFwic3JjXCIsIGV2ZW50SW1hZ2UpO1xuICAgICAgICAgICAgJCh0aGlzKS5hcHBlbmQoYFxuICAgICAgICAgICAgPHA+PGEgaHJlZj0gXCIke2V2ZW50VXJsfVwiIGNsYXNzPVwiZGF0YS11cmwtbGlua1wiIHRhcmdldCA9ICdfYmxhbmsnPiR7ZXZlbnROYW1lfTwvYT48L3A+XG4gICAgICAgICAgICA8aDU+JHtldmVudERhdGV9PC9oNT4gXG4gICAgICAgICAgICA8aDU+JCR7ZXZlbnRQcmljZX08YnV0dG9uIHN0eWxlPSdtYXJnaW4tbGVmdDogNzBweDsnIGNsYXNzID0gXCJidG4gYnRuLXNtIGJ0bi1vdXRsaW5lLWRhbmdlciBmYXZvcml0ZVwiIGV2ZW50LWltYWdlID1cIiR7ZXZlbnRJbWFnZX1cIiBldmVudC1uYW1lID0gXCIke2V2ZW50TmFtZX1cIiBldmVudC1wcmljZSA9IFwiJHtldmVudFByaWNlfVwiIGV2ZW50LXVybCA9IFwiJHtldmVudFVybH1cIj48aSBjbGFzcz0nZmFyIGZhLWhlYXJ0Jz48L2k+PC9idXR0b24+PC9oNT5cbiAgICAgICAgYCk7XG5cbiAgICAgICAgfSk7XG5cbiAgICB9KTtcblxuICAgIHZhciBjaG9zZW5QcmljZXMgPSBbXTtcbiAgICB2YXIgdG90YWwgPSAwO1xuICAgIHZhciBmYXZvcml0ZXMgPSB7fVxuICAgIHZhciBvdmVyID0gZmFsc2U7XG4gICAgdmFyIGZhdlN0cmluZyA9IGxvY2FsU3RvcmFnZS5nZXRJdGVtKFwiZmF2c1wiKTtcbiAgICB2YXIgZmF2cyA9IGZhdlN0cmluZyA/IEpTT04ucGFyc2UoZmF2U3RyaW5nKSA6IFtdO1xuXG4gICAgJChcIi50b3RhbFwiKS50ZXh0KHRvdGFsKTtcblxuICAgIGlmIChmYXZzLmxlbmd0aCA+IDApIHtcbiAgICAgICAgJChmYXZzKS5lYWNoKGZ1bmN0aW9uKGluZGV4KSB7XG4gICAgICAgICAgICB2YXIgJGRpdiA9ICQoXCI8ZGl2IGNsYXNzPSdjaG9zZW4tZGl2Jz5cIik7XG4gICAgICAgICAgICB2YXIgJGNvdW50ZXIgPSAkKGA8c3BhbiBkYXRhLWlkPVwiJHtmYXZzW2luZGV4XS5jb3VudH1cIj5gKTtcbiAgICAgICAgICAgIHZhciAkZmF2SW1hZ2UgPSAkKFwiPGltZyBjbGFzcz0naW1nLXBpY2tlZCcgLz5cIikuYXR0cihcInNyY1wiLCBmYXZzW2luZGV4XS5pbWFnZSk7XG4gICAgICAgICAgICB2YXIgJGZhdlRpdGxlID0gJChgXG4gICAgICAgICAgICAgICAgPGg2IGNsYXNzPVwiZmF2b3JpdGUtdGl0bGVcIj5cbiAgICAgICAgICAgICAgICAgICAgPHA+XG4gICAgICAgICAgICAgICAgICAgICAgICA8YSBocmVmPVwiJHtmYXZzW2luZGV4XS51cmx9XCIgdGFyZ2V0PVwiX2JsYW5rXCI+JHtmYXZzW2luZGV4XS5uYW1lfTwvYT5cbiAgICAgICAgICAgICAgICAgICAgPC9wPlxuICAgICAgICAgICAgICAgIDwvaDY+XG4gICAgICAgICAgICBgKVxuICAgICAgICAgICAgdmFyICRmYXZQcmljZSA9ICQoYDxoNiBjbGFzcz1cImZhdm9yaXRlLXRpdGxlXCI+JCR7ZmF2c1tpbmRleF0ucHJpY2V9IHggJHtmYXZzW2luZGV4XS5jb3VudH08L2g2PmApO1xuXG4gICAgICAgICAgICAkZmF2UHJpY2UuYXBwZW5kKCRjb3VudGVyKTtcbiAgICAgICAgICAgICRkaXYuYXR0cihcImNob3Nlbi1wcmljZVwiLCBmYXZzW2luZGV4XS5wcmljZSk7XG4gICAgICAgICAgICAkZGl2LmFwcGVuZCgkZmF2SW1hZ2UsICRmYXZUaXRsZSwgJGZhdlByaWNlKTtcblxuICAgICAgICAgICAgY2hvc2VuUHJpY2VzLnB1c2gocGFyc2VGbG9hdChmYXZzW2luZGV4XS5wcmljZSAqIGZhdnNbaW5kZXhdLmNvdW50KSk7XG4gICAgICAgICAgICB0b3RhbCA9IGNob3NlblByaWNlcy5yZWR1Y2UoYWRkLCAwKTtcbiAgICAgICAgICAgICQoXCIudG90YWxcIikudGV4dCh0b3RhbCk7XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgJChcIi5waWNrZWQtZXZlbnRzXCIpLmFwcGVuZCgkZGl2KTtcbiAgICAgICAgICAgICQoXCIucGlja2VkLWV2ZW50c1wiKS5zaG93KCk7XG5cbiAgICAgICAgICAgIGlmICh0b3RhbCA+IHBhcnNlRmxvYXQoYnVkZ2V0KSAmJiAhb3Zlcikge1xuICAgICAgICAgICAgICAgIHZhciBvdmVyQnVkZ2V0ID0gJChcIjxwIGNsYXNzPSdidWRnZXQgb3Zlcic+XCIpLnRleHQoXCJPdmVyIEJ1ZGdldCFcIik7XG4gICAgICAgICAgICAgICAgb3ZlciA9IHRydWU7XG4gICAgICAgICAgICAgICAgJChcIi5idWRnZXRcIikuYXBwZW5kKG92ZXJCdWRnZXQpO1xuICAgICAgICAgICAgICAgICQoXCIucGlja2VkLWV2ZW50c1wiKS5hZGRDbGFzcyhcIm92ZXItYnVkZ2V0XCIpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICB9XG5cbiAgICAkKGRvY3VtZW50KS5vbihcImNsaWNrXCIsIFwiLmZhdm9yaXRlXCIsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgJChcIi5waWNrZWQtZXZlbnRzXCIpLnNob3coKTtcbiAgICAgICAgdmFyIGV2ZW50RGl2ID0gJChcIjxkaXYgY2xhc3MgPSBjaG9zZW4tZGl2PlwiKTtcbiAgICAgICAgdmFyIGNvdW50ZXIgPSAkKFwiPHNwYW4gZGF0YS1pZCA9ICdcIiArICQodGhpcykuYXR0cihcImV2ZW50LW5hbWVcIikucmVwbGFjZShcIidcIiwgXCJcIikgKyBcIic+XCIpO1xuICAgICAgICB2YXIgZXZlbnRDaG9zZW4gPSAkKFwiPGltZyBjbGFzcyA9ICdpbWctcGlja2VkJz5cIikuYXR0cihcInNyY1wiLCAkKHRoaXMpLmF0dHIoXCJldmVudC1pbWFnZVwiKSk7XG4gICAgICAgIHZhciBldmVudFRpdGxlID0gJChcIjxoNiBjbGFzcyA9ICdmYXZvcml0ZS10aXRsZSc+XCIpLmFwcGVuZChgXG4gICAgICAgIDxwPjxhIGNsYXNzID0gXCJkYXRhLXVybC1saW5rLTJcIiBocmVmPSBcIiR7JCh0aGlzKS5hdHRyKFwiZXZlbnQtdXJsXCIpfVwiIHRhcmdldCA9ICdfYmxhbmsnPiR7JCh0aGlzKS5hdHRyKFwiZXZlbnQtbmFtZVwiKX08L2E+PC9wPiBcbiAgICAgICAgYCk7XG4gICAgICAgIHZhciBldmVudFByaWNlID0gJChcIjxoNiBjbGFzcyA9ICdmYXZvcml0ZS10aXRsZSc+XCIpLnRleHQoJyQnICsgJCh0aGlzKS5hdHRyKFwiZXZlbnQtcHJpY2VcIikgKyBcIiB4IFwiKTtcbiAgICAgICAgZXZlbnRQcmljZS5hcHBlbmQoY291bnRlcik7XG4gICAgICAgIGV2ZW50RGl2LmF0dHIoXCJjaG9zZW4tcHJpY2VcIiwgJCh0aGlzKS5hdHRyKFwiZXZlbnQtcHJpY2VcIikpO1xuICAgICAgICBldmVudERpdi5hcHBlbmQoZXZlbnRDaG9zZW4sIGV2ZW50VGl0bGUsIGV2ZW50UHJpY2UpO1xuXG4gICAgICAgIGZhdlN0cmluZyA9IGxvY2FsU3RvcmFnZS5nZXRJdGVtKFwiZmF2c1wiKTtcbiAgICAgICAgZmF2cyA9IGZhdlN0cmluZyA/IEpTT04ucGFyc2UoZmF2U3RyaW5nKSA6IGZhdnM7XG5cbiAgICAgICAgdmFyIGV2ZW50TmFtZVN0cmluZyA9ICQodGhpcykuYXR0cihcImV2ZW50LW5hbWVcIik7XG4gICAgICAgIFxuICAgICAgICBpZiAoZXZlbnROYW1lU3RyaW5nIGluIGZhdm9yaXRlcyAmJiBmYXZvcml0ZXMuaGFzT3duUHJvcGVydHkoZXZlbnROYW1lU3RyaW5nKSkge1xuICAgICAgICAgICAgZmF2b3JpdGVzW2V2ZW50TmFtZVN0cmluZ10rKztcbiAgICAgICAgICAgICQoXCJzcGFuW2RhdGEtaWQgPSAnXCIgKyBldmVudE5hbWVTdHJpbmcucmVwbGFjZShcIidcIixcIlwiKStcIiddXCIpLnRleHQoZmF2b3JpdGVzW2V2ZW50TmFtZVN0cmluZ10pO1xuICAgICAgICAgICAgXG4gICAgICAgICAgICB2YXIgaW5kZXggPSBmYXZzLmZpbmRJbmRleCgoZmF2KSA9PiBmYXYubmFtZSA9PT0gZXZlbnROYW1lU3RyaW5nKTtcbiAgICAgICAgICAgIGZhdnNbaW5kZXhdLmNvdW50ICs9IDE7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBmYXZvcml0ZXNbZXZlbnROYW1lU3RyaW5nXSA9IDE7XG4gICAgICAgICAgICAkKFwiLnBpY2tlZC1ldmVudHNcIikuYXBwZW5kKGV2ZW50RGl2KTtcbiAgICAgICAgICAgIGNvdW50ZXIudGV4dChmYXZvcml0ZXNbZXZlbnROYW1lU3RyaW5nXSk7XG5cbiAgICAgICAgICAgIGZhdnMucHVzaCh7XG4gICAgICAgICAgICAgICAgaW1hZ2U6ICQodGhpcykuYXR0cihcImV2ZW50LWltYWdlXCIpLFxuICAgICAgICAgICAgICAgIG5hbWU6IGV2ZW50TmFtZVN0cmluZyxcbiAgICAgICAgICAgICAgICBwcmljZTogJCh0aGlzKS5hdHRyKFwiZXZlbnQtcHJpY2VcIiksXG4gICAgICAgICAgICAgICAgdXJsOiAkKHRoaXMpLmF0dHIoXCJldmVudC11cmxcIiksXG4gICAgICAgICAgICAgICAgY291bnQ6IGZhdm9yaXRlc1tldmVudE5hbWVTdHJpbmddXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuXG4gICAgICAgIGxvY2FsU3RvcmFnZS5zZXRJdGVtKFwiZmF2c1wiLCBKU09OLnN0cmluZ2lmeShmYXZzKSk7ICBcblxuICAgICAgICBjb3VudGVyLnRleHQoZmF2b3JpdGVzWyQodGhpcykuYXR0cihcImV2ZW50LW5hbWVcIildKTtcbiAgICAgICAgLy8gdXBkYXRlIHRvdGFsIGV2ZXJ5IHRpbWUgYSBuZXcgZXZlbnQgaXMgYWRkZWQgdG8gZmF2b3JpdGVzIFxuICAgICAgICBjaG9zZW5QcmljZXMucHVzaChwYXJzZUZsb2F0KGV2ZW50RGl2LmF0dHIoXCJjaG9zZW4tcHJpY2VcIikpKTtcbiAgICAgICAgdG90YWwgPSBjaG9zZW5QcmljZXMucmVkdWNlKGFkZCwgMCk7XG4gICAgICAgICQoXCIudG90YWxcIikudGV4dCh0b3RhbCk7XG4gICAgICAgIFxuICAgICAgICBpZiAodG90YWwgPiBwYXJzZUZsb2F0KGJ1ZGdldCkgJiYgKG92ZXIgPT09IGZhbHNlKSl7XG4gICAgICAgICAgICBvdmVyID0gdHJ1ZTtcbiAgICAgICAgICAgIHZhciBvdmVyQnVkZ2V0ID0gJChcIjxwIGNsYXNzID0gJ2J1ZGdldCBvdmVyJz5cIikudGV4dChcIk92ZXIgQnVkZ2V0IVwiKTtcbiAgICAgICAgICAgICQoXCIub3ZlclwiKS5hcHBlbmQob3ZlckJ1ZGdldCk7XG4gICAgICAgICAgICAkKFwiLnBpY2tlZC1ldmVudHNcIikuYWRkQ2xhc3MoXCJvdmVyLWJ1ZGdldFwiKTtcbiAgICAgICAgfVxuICAgIH0pXG4gICAgXG4gICAgXG4gICAgJChkb2N1bWVudCkub24oXCJjbGlja1wiLCBcIi5jbGVhclwiLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgICQoXCIucGlja2VkLWV2ZW50c1wiKS5lbXB0eSgpO1xuICAgICAgICAkKFwiLnBpY2tlZC1ldmVudHNcIikuaGlkZSgpO1xuICAgICAgICAkKFwiLm92ZXJcIikuZW1wdHkoKTtcbiAgICAgICAgJChcIi5waWNrZWQtZXZlbnRzXCIpLnJlbW92ZUNsYXNzKFwib3Zlci1idWRnZXRcIik7XG4gICAgICAgIG92ZXIgPSBmYWxzZTtcbiAgICAgICAgY2hvc2VuUHJpY2VzID0gW107XG4gICAgICAgIHRvdGFsID0gMDtcbiAgICAgICAgZmF2b3JpdGVzID0ge307XG4gICAgICAgICQoXCIudG90YWxcIikudGV4dCh0b3RhbCk7XG4gICAgICAgIGxvY2FsU3RvcmFnZS5yZW1vdmVJdGVtKFwiZmF2c1wiKTtcbiAgICAgICAgZmF2cyA9IFtdO1xuICAgIH0pXG5cbiAgICBmdW5jdGlvbiBhZGQoYSwgYikge1xuICAgICAgICByZXR1cm4gYSArIGI7XG4gICAgfVxuXG5cbiAgICAvLyB0aWNrZXRtYXN0ZXIgc3BvcnRzIGV2ZW50cyBcbiAgICAkLmFqYXgoe1xuICAgICAgICB1cmw6IFwiaHR0cHM6Ly9hcHAudGlja2V0bWFzdGVyLmNvbS9kaXNjb3ZlcnkvdjIvZXZlbnRzLmpzb24/YXBpa2V5PXVnWFJTZnY4aVJJY2l4ZjhYYmlTckQwaUlnWWdPSEZxJmNsYXNzaWZpY2F0aW9uTmFtZT1zcG9ydHMmc2l6ZT01MCZjaXR5PVwiICsgY2l0eSArIFwiJnN0YXJ0RGF0ZT1cIiArIGRhdGUsXG4gICAgICAgIG1ldGhvZDogXCJHRVRcIlxuICAgIH0pLnRoZW4oZnVuY3Rpb24gKHJlc3BvbnNlKSB7XG5cbiAgICAgICAgdmFyIHNwb3J0c0V2ZW50cyA9IHJlc3BvbnNlLl9lbWJlZGRlZC5ldmVudHM7XG5cbiAgICAgICAgdmFyIGV2ZW50c1dpdGhQcmljZVJhbmdlcyA9IHNwb3J0c0V2ZW50cy5maWx0ZXIoZnVuY3Rpb24gKGV2ZW50KSB7XG4gICAgICAgICAgICByZXR1cm4gZXZlbnQucHJpY2VSYW5nZXM7XG4gICAgICAgIH0pO1xuXG4gICAgICAgIHZhciBldmVudHNJbkJ1ZGdldCA9IGV2ZW50c1dpdGhQcmljZVJhbmdlcy5maWx0ZXIoZnVuY3Rpb24gKGV2ZW50KSB7XG4gICAgICAgICAgICByZXR1cm4gZXZlbnQucHJpY2VSYW5nZXNbMF0ubWluIDw9IGJ1ZGdldDtcbiAgICAgICAgfSk7XG5cbiAgICAgICAgZXZlbnRzSW5CdWRnZXQgPSBldmVudHNJbkJ1ZGdldC5zbGljZSgwLCAxMik7XG5cblxuICAgICAgICB2YXIgc3BvcnRzQ2Fyb3VzZWxJdGVtcyA9ICQoXCIuY2Fyb3VzZWxTcG9ydHMgLmNhcm91c2VsLWl0ZW0gLnNwb3J0c1wiKTtcblxuICAgICAgICBzcG9ydHNDYXJvdXNlbEl0ZW1zLmVhY2goZnVuY3Rpb24gKGkpIHtcbiAgICAgICAgICAgIHZhciBpbWFnZUluZGV4ID0gZXZlbnRzSW5CdWRnZXRbaV0uaW1hZ2VzLmZpbmRJbmRleChmdW5jdGlvbiAoaW1hZ2UpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gaW1hZ2Uud2lkdGggPT09IDIwNTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgdmFyIGV2ZW50SW1hZ2UgPSBldmVudHNJbkJ1ZGdldFtpXS5pbWFnZXNbaW1hZ2VJbmRleF0udXJsO1xuICAgICAgICAgICAgdmFyIGV2ZW50VXJsID0gZXZlbnRzSW5CdWRnZXRbaV0udXJsO1xuICAgICAgICAgICAgdmFyIGV2ZW50UHJpY2UgPSBldmVudHNJbkJ1ZGdldFtpXS5wcmljZVJhbmdlc1swXS5taW47XG4gICAgICAgICAgICB2YXIgZXZlbnROYW1lID0gZXZlbnRzSW5CdWRnZXRbaV0ubmFtZTtcbiAgICAgICAgICAgIHZhciBldmVudERhdGUgPSBldmVudHNJbkJ1ZGdldFtpXS5kYXRlcy5zdGFydC5sb2NhbERhdGU7XG5cbiAgICAgICAgICAgICQodGhpcykuZmluZChcImltZ1wiKS5hdHRyKFwic3JjXCIsIGV2ZW50SW1hZ2UpO1xuICAgICAgICAgICAgJCh0aGlzKS5hcHBlbmQoYFxuICAgICAgICAgICAgPHA+PGEgaHJlZj0gXCIke2V2ZW50VXJsfVwiIGNsYXNzID1cImRhdGEtdXJsLWxpbmtcIiB0YXJnZXQgPSAnX2JsYW5rJz4ke2V2ZW50TmFtZX08L2E+PC9wPlxuICAgICAgICAgICAgPGg1PiR7ZXZlbnREYXRlfTwvaDU+IFxuICAgICAgICAgICAgPGg1PiQke2V2ZW50UHJpY2V9PGJ1dHRvbiBzdHlsZT0nbWFyZ2luLWxlZnQ6IDcwcHg7JyBjbGFzcyA9ICdidG4gYnRuLXNtIGJ0bi1vdXRsaW5lLWRhbmdlciBmYXZvcml0ZScgZXZlbnQtaW1hZ2UgPVwiJHtldmVudEltYWdlfVwiIGV2ZW50LW5hbWUgPSBcIiR7ZXZlbnROYW1lfVwiIGV2ZW50LXByaWNlID0gXCIke2V2ZW50UHJpY2V9XCIgZXZlbnQtdXJsID0gXCIke2V2ZW50VXJsfVwiPjxpIGNsYXNzPSdmYXIgZmEtaGVhcnQnPjwvaT48L2J1dHRvbj4gPC9oNT5cbiAgICAgICAgYCk7XG5cblxuICAgICAgICB9KTtcblxuXG4gICAgfSlcblxuXG5cblxuXG59KTtcbiIsIiQoZG9jdW1lbnQpLnJlYWR5KGZ1bmN0aW9uICgpIHtcbi8vIFNhdmVzIHVzZXIgaW5wdXQgd2hlbiBzdWJtaXQgYnV0dG9uIGlzIGNsaWNrZWRcbiAgICAkKFwiI3N1Ym1pdF9idXR0b25cIikuY2xpY2soZnVuY3Rpb24oKXtcbiAgICAgICAgbG9jYWxTdG9yYWdlLnJlbW92ZUl0ZW0oXCJmYXZzXCIpO1xuICAgICAgICB2YXIgZGF0ZV9pbnB1dCA9ICQoXCIjZGF0ZUlucHV0XCIpLnZhbCgpO1xuICAgICAgICB2YXIgYnVkZ2V0X2lucHV0ID0gJChcIiNidWRnZXRJbnB1dCBvcHRpb246c2VsZWN0ZWRcIikudmFsKCk7XG4gICAgICAgIHZhciBjaXR5X2lucHV0ID0gJChcIiNjaXR5SW5wdXRcIikudmFsKCk7XG5cbiAgICAgICAgdmFyIGRhdGVQYXR0ZXJuID0gL15cXGR7NH1cXC0oMFsxLTldfDFbMC0yXSlcXC0oMFsxLTldfDFbMC05XXwyWzAtOV18M1swLTFdKSQvaVxuICAgICAgICB2YXIgbG9jYXRpb25QYXR0ZXJuID0gL15cXHd7Mix9KFxcc1xcd3syLH0pezAsMn0kL2k7XG4gICAgICAgIFxuICAgICAgICB2YXIgdmFsaWQgPSBkYXRlUGF0dGVybi50ZXN0KGRhdGVfaW5wdXQpO1xuICAgICAgICBcbiAgICAgICAgaWYgKHZhbGlkKSB7XG4gICAgICAgICAgICAkKFwiI2RhdGVJbnB1dFwiKS5yZW1vdmVDbGFzcyhcIndyb25nLWlucHV0XCIpO1xuICAgICAgICAgICAgJChcIi5jLWRhdGVcIikuZW1wdHkoKTtcbiAgICAgICAgICAgICQoXCIuc3VibWl0XCIpLmF0dHIoXCJocmVmXCIsIFwiaG9tZXBhZ2UuaHRtbFwiKVxuICAgICAgICAgICAgbG9jYWxTdG9yYWdlLnNldEl0ZW0oXCJkYXRlXCIsIGRhdGVfaW5wdXQpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgJChcIiNkYXRlSW5wdXRcIikuYWRkQ2xhc3MoXCJ3cm9uZy1pbnB1dFwiKTtcbiAgICAgICAgICAgICQoXCIjZGF0ZUlucHV0XCIpLmF0dHIoXCJwbGFjZWhvbGRlclwiLCBcIllZWVktTU0tRERcIik7XG4gICAgICAgICAgICAkKFwiLmMtZGF0ZVwiKS50ZXh0KFwiSW5jb3JyZWN0IGRhdGUgZm9ybWF0XCIpO1xuICAgICAgICAgICAgJChcIi5zdWJtaXRcIikuYXR0cihcImhyZWZcIiwgXCIjXCIpXG4gICAgICAgICAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICB9XG4gICAgICAgIFxuXG4gICAgICAgIHZhciB2YWxpZCA9IGxvY2F0aW9uUGF0dGVybi50ZXN0KGNpdHlfaW5wdXQpO1xuXG4gICAgICAgIGlmICh2YWxpZCkge1xuICAgICAgICAgICAgJChcIiNjaXR5SW5wdXRcIikucmVtb3ZlQ2xhc3MoXCJ3cm9uZy1pbnB1dFwiKTtcbiAgICAgICAgICAgICQoXCIuYy1jaXR5XCIpLmVtcHR5KCk7XG4gICAgICAgICAgICAkKFwiLnN1Ym1pdFwiKS5hdHRyKFwiaHJlZlwiLCBcImhvbWVwYWdlLmh0bWxcIilcbiAgICAgICAgICAgIGxvY2FsU3RvcmFnZS5zZXRJdGVtKFwiY2l0eVwiLCBjaXR5X2lucHV0KTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICQoXCIjY2l0eUlucHV0XCIpLmFkZENsYXNzKFwid3JvbmctaW5wdXRcIik7XG4gICAgICAgICAgICAkKFwiLmMtY2l0eVwiKS50ZXh0KFwiSW52YWxpZCBjaXR5XCIpO1xuICAgICAgICAgICAgJChcIi5zdWJtaXRcIikuYXR0cihcImhyZWZcIiwgXCIjXCIpXG4gICAgICAgICAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICAgICAgXG4gICAgICAgIH1cblxuICAgICAgICBpZihidWRnZXRfaW5wdXQgPT09IFwiU2VsZWN0IGJ1ZGdldFwiKXtcbiAgICAgICAgICAgICQoXCIjYnVkZ2V0SW5wdXRcIikuYWRkQ2xhc3MoXCJ3cm9uZy1pbnB1dFwiKTtcbiAgICAgICAgICAgICQoXCIuYy1idWRnZXRcIikudGV4dChcIkNob29zZSBCdWRnZXRcIik7XG4gICAgICAgICAgICAkKFwiLnN1Ym1pdFwiKS5hdHRyKFwiaHJlZlwiLCBcIiNcIilcbiAgICAgICAgICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAkKFwiI2J1ZGdldElucHV0XCIpLnJlbW92ZUNsYXNzKFwid3JvbmctaW5wdXRcIik7XG4gICAgICAgICAgICAkKFwiLmMtYnVkZ2V0XCIpLmVtcHR5KCk7XG4gICAgICAgICAgICAkKFwiLnN1Ym1pdFwiKS5hdHRyKFwiaHJlZlwiLCBcImhvbWVwYWdlLmh0bWxcIilcbiAgICAgICAgICAgIGxvY2FsU3RvcmFnZS5zZXRJdGVtKFwiYnVkZ2V0XCIsIGJ1ZGdldF9pbnB1dCk7XG4gICAgICAgIH1cblxuICAgICAgICBcbiAgICAgICAgXG4gICAgfSk7XG59KTsiLCIkKGRvY3VtZW50KS5yZWFkeShmdW5jdGlvbiAoKSB7XG5cbiAgICAkKFwiLm5hdi1yZXN0YXVyYW50c1wiKS5jbGljayhmdW5jdGlvbiAoKSB7XG4gICAgICAgICQoJ2h0bWwsYm9keScpLmFuaW1hdGUoe1xuICAgICAgICAgICAgc2Nyb2xsVG9wOiAkKFwiLm5hdjItcmVzdGF1cmFudHNcIikub2Zmc2V0KCkudG9wXG4gICAgICAgIH0sXG4gICAgICAgICAgICAnc2xvdycpO1xuICAgIH0pO1xuXG4gICAgJChcIi5uYXYtY29uY2VydHNcIikuY2xpY2soZnVuY3Rpb24gKCkge1xuICAgICAgICAkKCdodG1sLGJvZHknKS5hbmltYXRlKHtcbiAgICAgICAgICAgIHNjcm9sbFRvcDogJChcIi5uYXYyLWNvbmNlcnRzXCIpLm9mZnNldCgpLnRvcFxuICAgICAgICB9LFxuICAgICAgICAgICAgJ3Nsb3cnKTtcbiAgICB9KTtcblxuICAgICQoXCIubmF2LXNwb3J0aW5nLWV2ZW50c1wiKS5jbGljayhmdW5jdGlvbiAoKSB7XG4gICAgICAgICQoJ2h0bWwsYm9keScpLmFuaW1hdGUoe1xuICAgICAgICAgICAgc2Nyb2xsVG9wOiAkKFwiLm5hdjItc3BvcnRpbmctZXZlbnRzXCIpLm9mZnNldCgpLnRvcFxuICAgICAgICB9LFxuICAgICAgICAgICAgJ3Nsb3cnKTtcbiAgICB9KTtcblxuICAgICQoXCIuZGF0YS1ob21lLWZvb3RlclwiKS5jbGljayhmdW5jdGlvbiAoKSB7XG4gICAgICAgICQoJ2h0bWwsYm9keScpLmFuaW1hdGUoe1xuICAgICAgICAgICAgc2Nyb2xsVG9wOiAkKFwiLmRhdGEtaG9tZVwiKS5vZmZzZXQoKS50b3BcbiAgICAgICAgfSxcbiAgICAgICAgICAgICdzbG93Jyk7XG4gICAgfSk7XG5cbiAgICAkKFwiLm5hdi1jYXJ0XCIpLmNsaWNrKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgJCgnaHRtbCxib2R5JykuYW5pbWF0ZSh7XG4gICAgICAgICAgICBzY3JvbGxUb3A6ICQoXCIuc2hvcHBpbmctY2FydFwiKS5vZmZzZXQoKS50b3BcbiAgICAgICAgfSxcbiAgICAgICAgICAgICdzbG93Jyk7XG4gICAgfSk7XG5cblxuICAgICQoJy5kaXNjbGFpbWVyJykuY2xpY2sgKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgJCgnI215SW5wdXQnKS50cmlnZ2VyKCdmb2N1cycpXG4gICAgfSlcblxuXG59KTtcbiIsIi8qKlxuICogWWVscCBBUEkgUmVxdWVzdCAmIEluZm9ybWF0aW9uIENvbGxlY3Rpb25cbiAqL1xuXG4vLyBWYXJpYWJsZXNcbi8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tPlxuY29uc3QgdXNlclBhcmFtcyA9IHtcbiAgICBsb2NhdGlvbjogbG9jYWxTdG9yYWdlLmdldEl0ZW0oXCJjaXR5XCIpLFxuICAgIG1heEJ1ZGdldDogbG9jYWxTdG9yYWdlLmdldEl0ZW0oXCJidWRnZXRcIilcbn0sXG5kb2xsYXJzID0ge1xuICAgICQ6IDgsXG4gICAgJCQ6IDE1LFxuICAgICQkJDogNDAsXG4gICAgJCQkJDogNjFcbn07XG5cbi8vIERPTSBTZWxlY3Rpb25zXG4vLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLT5cbmNvbnN0IHJlc3RhdXJhbnRDb2x1bW5zID0gJChcIi5jYXJvdXNlbFJlc3RhdXJhbnRzIC5idXNpbmVzc1wiKTtcblxuLy8gRnVuY3Rpb25zXG4vLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLT5cblxuLy8gR2V0IGJ1c2luZXNzZXMgd2l0aCBwcmljZXMgLS0+XG5jb25zdCBnZXRCdXNpbmVzc2VzV2l0aFByaWNlcyA9IChidXNpbmVzc2VzKSA9PiB7XG4gICAgcmV0dXJuIGJ1c2luZXNzZXMuZmlsdGVyKChidXNpbmVzcykgPT4gYnVzaW5lc3MucHJpY2UpO1xufVxuXG4vLyBTb3J0IHllbHAgYnVzaW5lc3NlcyAtLT5cbmNvbnN0IHNvcnRZZWxwQnVzaW5lc3NlcyA9IChidXNpbmVzc2VzKSA9PiB7XG4gICAgY29uc3QgYnlCZXN0UmF0aW5nID0gYnVzaW5lc3Nlcy5zbGljZSgpO1xuXG4gICAgYnlCZXN0UmF0aW5nLnNvcnQoKGEsIGIpID0+IHtcbiAgICAgICAgaWYgKGIucmF0aW5nIDwgYS5yYXRpbmcpIHtcbiAgICAgICAgICAgIHJldHVybiAtMTtcbiAgICAgICAgfSBlbHNlIGlmIChhLnJhdGluZyA8IGIucmF0aW5nKSB7XG4gICAgICAgICAgICByZXR1cm4gMTtcbiAgICAgICAgfVxuXG4gICAgICAgIGlmIChhLnByaWNlICYmIGIucHJpY2UpIHtcbiAgICAgICAgICAgIGlmIChiLnByaWNlID4gYS5wcmljZSkge1xuICAgICAgICAgICAgICAgIHJldHVybiAtMTtcbiAgICAgICAgICAgIH0gZWxzZSBpZiAoYS5wcmljZSA+IGIucHJpY2UpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gMTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBcbiAgICAgICAgcmV0dXJuIDA7XG4gICAgfSk7ICAgICAgICBcbiAgICBcbiAgICByZXR1cm4gYnlCZXN0UmF0aW5nLnNwbGljZSgwLCAxMik7XG59O1xuXG4vLyBBcHBlbmQgeWVscCBidXNpbmVzcyBlbGVtZW50cyAtLT5cbmNvbnN0IGFwcGVuZFllbHBCdXNpbmVzc0VsZW1lbnRzID0gKGJ1c2luZXNzZXMpID0+IHtcbiAgICByZXN0YXVyYW50Q29sdW1ucy5lYWNoKGZ1bmN0aW9uKGluZGV4KSB7XG4gICAgICAgIGxldCB7cmF0aW5nLCB1cmwsIGltYWdlX3VybCwgcHJpY2UsIG5hbWV9ID0gYnVzaW5lc3Nlc1tpbmRleF07XG4gICAgICAgIHByaWNlID0gcHJpY2UgPyBkb2xsYXJzW3ByaWNlXSA6IFwiTm8gUHJpY2VcIjtcbiAgICAgICAgXG4gICAgICAgICQodGhpcykuZmluZChcImltZ1wiKS5hdHRyKFwic3JjXCIsIGltYWdlX3VybCk7XG4gICAgICAgICQodGhpcykuYXBwZW5kKGBcbiAgICAgICAgICAgIDxwIGNsYXNzPVwibXktMFwiPlxuICAgICAgICAgICAgICAgIDxhIGhyZWY9XCIke3VybH1cIiBjbGFzcz1cImRhdGEtdXJsLWxpbmtcIiB0YXJnZXQ9XCJfYmxhbmtcIj4ke25hbWV9PC9hPlxuICAgICAgICAgICAgPC9wPlxuICAgICAgICAgICAgPHAgY2xhc3M9XCJteS0wXCI+UmF0aW5nOiAke3JhdGluZ308L3A+XG4gICAgICAgICAgICA8cCBjbGFzcz1cIm15LTBcIj5QcmljZTogJCR7cHJpY2UudG9GaXhlZCgyKX1cbiAgICAgICAgICAgICAgICA8YnV0dG9uIHN0eWxlPVwibWFyZ2luLWxlZnQ6IDcwcHg7XCIgY2xhc3M9XCJidG4gYnRuLXNtIGJ0bi1vdXRsaW5lLWRhbmdlciBmYXZvcml0ZVwiIGV2ZW50LWltYWdlPVwiJHtpbWFnZV91cmx9XCIgZXZlbnQtbmFtZT1cIiR7bmFtZX1cIiBldmVudC1wcmljZT1cIiR7cHJpY2V9XCIgZXZlbnQtdXJsID0gXCIke3VybH1cIj48aSBjbGFzcz1cImZhciBmYS1oZWFydFwiPjwvaT48L2J1dHRvbj5cbiAgICAgICAgICAgIDwvcD5cbiAgICAgICAgYCk7XG4gICAgfSk7XG59O1xuXG4vLyBHZXQsIHNvcnQsIGNyZWF0ZSAmIGRpc3BsYXkgeWVscCBidXNpbmVzcyBlbGVtZW50cyAtLT5cbmNvbnN0IGdldFNvcnRDcmVhdGVZZWxwQnVzaW5lc3NFbGVtZW50cyA9ICh1c2VyUGFyYW1zKSA9PiB7XG4gICAgY29uc3QgZW5jb2RlZExvY2F0aW9uID0gZW5jb2RlVVJJKHVzZXJQYXJhbXMubG9jYXRpb24pLFxuICAgICAgICB1cmwgPSBgaHR0cHM6Ly9jb3JzLWFueXdoZXJlLmhlcm9rdWFwcC5jb20vaHR0cHM6Ly9hcGkueWVscC5jb20vdjMvYnVzaW5lc3Nlcy9zZWFyY2g/dGVybT1mb29kJmxvY2F0aW9uPSR7ZW5jb2RlZExvY2F0aW9ufWA7XG5cbiAgICAkLmFqYXgoe1xuICAgICAgICB1cmwsXG4gICAgICAgIG1ldGhvZDogXCJHRVRcIixcbiAgICAgICAgaGVhZGVyczoge1xuICAgICAgICAgICAgQXV0aG9yaXphdGlvbjogXCJCZWFyZXIgRUp2YkhaaUlzNU9tUDJpNWpFUEFqSzBLQl8yOVdmeDMyRlNsaTRZWnZDVm00R2s2Tm8wYWhUbklUYWtFM1hkeVNkNW9WQnJWQUFNbk9JZWtRVWU0ZFRSYlJMc1JGcC0tTkQ5QlB1WTdXYkJxaUdjc3VscWx1NlhJM29XUlczWXhcIlxuICAgICAgICB9XG4gICAgfSkudGhlbigocmVzKSA9PiB7XG4gICAgICAgIGNvbnN0IHtidXNpbmVzc2VzfSA9IHJlcyxcbiAgICAgICAgYnVzaW5lc3Nlc1dpdGhQcmljZXMgPSBnZXRCdXNpbmVzc2VzV2l0aFByaWNlcyhidXNpbmVzc2VzKSxcbiAgICAgICAgc29ydGVkQnVzaW5lc3NlcyA9IHNvcnRZZWxwQnVzaW5lc3NlcyhidXNpbmVzc2VzV2l0aFByaWNlcyk7XG4gICAgICAgIGFwcGVuZFllbHBCdXNpbmVzc0VsZW1lbnRzKHNvcnRlZEJ1c2luZXNzZXMpO1xuICAgIH0pO1xufTtcblxuLy8gTWFpblxuLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0+XG5nZXRTb3J0Q3JlYXRlWWVscEJ1c2luZXNzRWxlbWVudHModXNlclBhcmFtcyk7XG4iXX0=
